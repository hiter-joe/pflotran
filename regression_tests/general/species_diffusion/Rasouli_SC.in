#Description: 1D test problem for tracer transport

SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_TRANSPORT transport
      MODE GIRT
      OPTIONS
      /
    /
  /
END

SUBSURFACE

#=========================== chemistry ========================================
CHEMISTRY

    PRIMARY_SPECIES
        Tracer
        H+
        Na+
        Cl-
        NO3-        
    END
    SECONDARY_SPECIES
        OH-
    END

    AQUEOUS_DIFFUSION_COEFFICIENTS
        Tracer 1.87d-9
        H+ 9.31d-9
        Na+ 1.33d-9
        Cl- 2.03d-9
        NO3- 1.90d-9
        OH- 5.27d-9
    END


    ACTIVITY_COEFFICIENTS TIMESTEP
    DATABASE hanford_reduced.dat
    LOG_FORMULATION
    OUTPUT
        PH
        all
        TOTAL
    /
END


#=========================== discretization ===================================
GRID
    TYPE structured
    ORIGIN 0.d0 0.d0 0.d0
    NXYZ 100 1 1
    BOUNDS
        0.d0 0.d0 0.d0
        1.d-2 1.0 1.0
    /
END

#=========================== numerical methods =================================

NUMERICAL_METHODS TRANSPORT
  TIMESTEPPER
    CFL_GOVERNOR 1.d0

  /
  NEWTON_SOLVER
	MATRIX_TYPE AIJ
	PRECONDITIONER_MATRIX_TYPE AIJ
  /
  LINEAR_SOLVER
    SOLVER DIRECT
  /
END


#=========================== flow velocity ===================================

SPECIFIED_VELOCITY
  UNIFORM? YES
  DATASET 0d0 0.d0 0.d0 m/yr
END

#=========================== fluid properties =================================
FLUID_PROPERTY
    DIFFUSION_COEFFICIENT 2.03d-9
/

#=========================== material properties ==============================
MATERIAL_PROPERTY diffusiveMaterial
    ID 1
    POROSITY 1d0
    TORTUOSITY 1.d0
    LONGITUDINAL_DISPERSIVITY 0d0
    CHARACTERISTIC_CURVES default
/

MATERIAL_PROPERTY sourceMaterial
    ID 2
    POROSITY 50000d0
    TORTUOSITY 1.d0
    LONGITUDINAL_DISPERSIVITY 0d0
    CHARACTERISTIC_CURVES default
/

#=========================== characteristic curves ============================
CHARACTERISTIC_CURVES default
  DEFAULT
END

#=========================== output options ===================================
OUTPUT

  SNAPSHOT_FILE
    FORMAT HDF5
    FORMAT TECPLOT POINT
    PERIODIC TIME 1 h
    VARIABLES
    /
    VELOCITY_AT_CENTER
  /
  OBSERVATION_FILE
  PERIODIC TIME 0.000416 day
  VARIABLES
        /
  /
/

#=========================== times ============================================
TIME
    FINAL_TIME 1 h
    INITIAL_TIMESTEP_SIZE 0.01 h
    MAXIMUM_TIMESTEP_SIZE 0.001 h
/

#=========================== regions ==========================================

REGION horizontalBottom
    COORDINATES
    1.d-4 0.d0 0.d0
    1.d-2 1.0  1.0
    /
END

REGION sourceConcentrationRegion
    COORDINATES
    0.d0 0.d0 0.d0
    1.d-4 1.0 1.0
    /
END

REGION east
    FACE EAST
    COORDINATES
    1.d-2 0.d0 0.d0
    1.d-2 1.0 1.0
    /
END

#=========================== observations =====================================

OBSERVATION
    REGION east
    #VELOCITY
    #REGION source
/

#=========================== transport conditions =============================
TRANSPORT_CONDITION sourceConcentrationCondition
    TYPE zero_gradient
    CONSTRAINT_LIST
    0.d0 sourceConcentrationConstraint
    /
END

TRANSPORT_CONDITION initialConcentrationCondition
    TYPE zero_gradient
    CONSTRAINT_LIST
    0.d0 initialConcentrationConstraint
    /
END


#=========================== constraints ======================================
CONSTRAINT sourceConcentrationConstraint
    CONCENTRATIONS
    Tracer 1.d-3 T
    H+    6.001 pH
    Na+   1d-4 T
    Cl-   1d-4 T
    NO3-  1d-6 T
    /
END

CONSTRAINT initialConcentrationConstraint
    CONCENTRATIONS
    Tracer      1d-8 T
    H+          4.007 pH
    Na+         1d-4 T
    Cl-         1d-4 T
    NO3-        1d-4 T
    /
END


#=========================== condition couplers ===============================
# initial condition
INITIAL_CONDITION
    TRANSPORT_CONDITION initialConcentrationCondition
    REGION horizontalBottom
END

INITIAL_CONDITION
    TRANSPORT_CONDITION sourceConcentrationCondition
    REGION sourceConcentrationRegion
END


#=========================== stratigraphy couplers ============================
STRATA
    REGION horizontalBottom
    MATERIAL diffusiveMaterial
END
STRATA
    REGION sourceConcentrationRegion
    MATERIAL sourceMaterial
END

END_SUBSURFACE

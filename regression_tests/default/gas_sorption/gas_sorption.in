SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE GENERAL
    END
    SUBSURFACE_TRANSPORT transport
      MODE GIRT
    END
  /
END

SUBSURFACE
#======================= numerical methods
NUMERICAL_METHODS flow 
  NEWTON_SOLVER
    USE_INFINITY_NORM_CONVERGENCE
    PRESSURE_CHANGE_LIMIT 5.d6
  /
END

NUMERICAL_METHODS transport
  NEWTON_SOLVER
    RTOL 1.d-08
    ATOL 1.d-12
    STOL 1D-30
    MAXIMUM_NUMBER_OF_ITERATIONS 100
    MAXF 1000
    MINIMUM_NEWTON_ITERATIONS 3
  /
  TIMESTEPPER TRANSPORT
    TS_ACCELERATION 32
  END

  LINEAR_SOLVER
    RTOL 1.d-12
    ATOL 1.d-12
  !  KSP_TYPE GMRES
    LU_ZERO_PIVOT_TOL 1.d-15
  /
END
#======================= regression
REGRESSION
  CELLS_PER_PROCESS 1
END
#======================= eos
EOS WATER
  DENSITY IF97
  ENTHALPY IF97
  STEAM_DENSITY IF97
  STEAM_ENTHALPY IF97
/
EOS GAS
  DENSITY IDEAL
  HENRYS_CONSTANT CONSTANT 1.d19
/

#======================= chemistry

CHEMISTRY
  PRIMARY_SPECIES
    A(aq)
  END
  ACTIVE_GAS_SPECIES
    GAS_TRANSPORT_IS_UNVETTED 
    A(g)
  END
  PASSIVE_GAS_SPECIES
    A(g)
  END

  AQUEOUS_DIFFUSION_COEFFICIENTS
    A(aq)  1.5e-5 cm^2/sec  
  END

  GAS_DIFFUSION_COEFFICIENTS
    A(g)  0.124 cm^2/sec  
  END
  SORPTION
    ISOTHERM_REACTIONS
      A(aq)
        DISTRIBUTION_COEFFICIENT 0.d0
      END
    END
  END

  GAS_SORPTION
    ISOTHERM_REACTIONS
      A(g)
	RETENTION_FACTOR 1.D1 ! Equal partitioning between sorbed and gaseous quantities
      END
    END
  END

  DATABASE ../../../database/gas_database.dat
  LOG_FORMULATION
  OUTPUT
    GASES
  END

END

#=========================== times
TIME
  FINAL_TIME 50.0 d
  INITIAL_TIMESTEP_SIZE 1.d-3 d
  MAXIMUM_TIMESTEP_SIZE 10 d
END

FLUID_PROPERTY
  PHASE LIQUID
  DIFFUSION_COEFFICIENT 0.d0
END

FLUID_PROPERTY
  PHASE GAS
  DIFFUSION_COEFFICIENT 0.d0
END

#=========================== discretization
GRID
  TYPE STRUCTURED
  NXYZ 3 1 1
  BOUNDS
    0.d0 0.d0 0.d0
    110.d0 1.d1 1.d1
  END
  GRAVITY  0.0D+0 0.0+0 -9.8068D+0 # Z is depth 
END

#=========================== output options
OUTPUT
  VARIABLES
    GAS_SATURATION
    GAS_PRESSURE
    LIQUID_PRESSURE
    LIQUID_SATURATION
    TEMPERATURE
    THERMODYNAMIC_STATE
    MATERIAL_ID
    CAPILLARY_PRESSURE
  END
skip
  SNAPSHOT_FILE
    PERIODIC TIME 10 d between 0.0 d and 50 d
    FORMAT HDF5
    VELOCITY_AT_CENTER
  END
noskip
END

#========================== materials/characteristic curves

MATERIAL_PROPERTY sandstone
  ID 1
  CHARACTERISTIC_CURVES default
  POROSITY 0.20
  !TORTUOSITY 0.20
  TORTUOSITY_FUNCTION_OF_POROSITY 0.333 #Millington and Quirk
  SOIL_COMPRESSIBILITY 3.2d-9 #1/Pa, what Payton used in 2015 clay case
  SOIL_COMPRESSIBILITY_FUNCTION LEIJNSE
  SOIL_REFERENCE_PRESSURE 101325.d0
  ROCK_DENSITY 2700.
  THERMAL_CONDUCTIVITY_DRY 1.0d0 #complete guess
  THERMAL_CONDUCTIVITY_WET 3.1d0 #Forster and Merriam 197, Dakota sandstone
  HEAT_CAPACITY 830.
  PERMEABILITY
    PERM_ISO 1.d-12
  /
/

CHARACTERISTIC_CURVES default
  SATURATION_FUNCTION VAN_GENUCHTEN
    ALPHA 1.d-4
    M 0.5
    LIQUID_RESIDUAL_SATURATION 0.1d0
    MAX_CAPILLARY_PRESSURE 1.d7
  /
  PERMEABILITY_FUNCTION MUALEM_VG_LIQ
    PHASE LIQUID
    M 0.5
    LIQUID_RESIDUAL_SATURATION 0.1d0
  /
  PERMEABILITY_FUNCTION MUALEM_VG_GAS
    PHASE GAS
    M 0.5
    LIQUID_RESIDUAL_SATURATION 0.1d0
    GAS_RESIDUAL_SATURATION 0.1d0
  /
END

#=========================== regions
REGION all
  COORDINATES
   -1.0D+20 -1.0D+20 -1.0D+20
    1.0D+20  1.0D+20  1.0D+20
  /
END

REGION west
  FACE WEST
  COORDINATES
    0.d0 0.d0 0.d0
    0.d0 1.d1 1.d1
  /
END

REGION east
  FACE EAST
  COORDINATES
    110.d0 0.d0 0.d0
    110.d0 1.d1 1.d1    
  /
END
# ======================= flow condition
FLOW_CONDITION initial
  TYPE
    TEMPERATURE DIRICHLET
    GAS_PRESSURE DIRICHLET
    GAS_SATURATION DIRICHLET
  END
  TEMPERATURE 2.5d1
  GAS_PRESSURE 1.0d5
  GAS_SATURATION 9.99999d-1
END

FLOW_CONDITION west
  TYPE
    TEMPERATURE DIRICHLET
    GAS_PRESSURE DIRICHLET
    GAS_SATURATION DIRICHLET
  END
  TEMPERATURE 2.5d1
  GAS_PRESSURE 1.1d5
  GAS_SATURATION 9.99999d-1
END

CONSTRAINT initial
  CONCENTRATIONS
    A(aq)  1.00D-20 G   A(g)
  END
END

TRANSPORT_CONDITION initial
  TYPE DIRICHLET_ZERO_GRADIENT
  CONSTRAINT_LIST
    0.0D+0 initial
  END
/

CONSTRAINT inj
  CONCENTRATIONS
    A(aq)  8.84e-9 G  A(g)
  END
END

TRANSPORT_CONDITION inj
  TYPE DIRICHLET_ZERO_GRADIENT
  CONSTRAINT_LIST
    0.0D+0 inj
  END
END

INITIAL_CONDITION initial
  FLOW_CONDITION initial
  TRANSPORT_CONDITION initial
  REGION all
END
BOUNDARY_CONDITION west
  FLOW_CONDITION west
  TRANSPORT_CONDITION inj
  REGION west
END

BOUNDARY_CONDITION east
  FLOW_CONDITION initial
  TRANSPORT_CONDITION initial
  REGION east
END


STRATA
  REGION all
  MATERIAL sandstone
END

END_SUBSURFACE

